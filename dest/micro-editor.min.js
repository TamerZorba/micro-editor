var microEditor=function(b){var c=this;return this.options={el:"editor",toolbar:"undo redo bold italic underline strikeThrough justifyLeft justifyCenter justifyRight justifyFull blockquote indent outdent insertUnorderedList insertOrderedList createlink unlink insertimage subscript superscript removeFormat print",debugMode:!1,pastAsPlain:!1,preventPaste:!1,expandable:!1,showOnFocus:!1,position:"top",height:100,debounce:10},this["extends"]=function(a,b){for(var c in b)a[c]=b[c];return a},b instanceof Object&&(this["extends"](this.options,b),b=this.options.el),b instanceof Element?this.el=b:this.el=document.getElementById(b),this.el||console.error("No Element called "+id),window.microEditorObject||(window.microEditorObject={},window.microEditorObject.counter=0),window.microEditorObject.counter++,this.idx=window.microEditorObject.counter,this.init=function(){this.prepare(),"top"!=this.options.position&&this.create.editor();for(var a in microEditor.plugins.init)microEditor.plugins.init[a].call(this);var b=this.options.toolbar.split(" ");for(var a in b)microEditor.plugins.list[b[a]]?microEditor.plugins.list[b[a]].call(this):""!==b[a].trim()&&console.error(b[a]);"top"==this.options.position&&this.create.editor(),this.editor.innerHTML=this.el.value,this.register.event.dropdownCloseListener()},this.create={button:function(b,d){var e=document.createElement("div"),f=document.createElement("button");if(e.classList.add("button-container"),e.appendChild(f),e.addEventListener("mousedown",function(a){a.preventDefault()}),d){var g=document.createTextNode(b);f.appendChild(g)}else d=b;return f.addEventListener("click",function(a){a.preventDefault(),d&&d.call(c,f,a),c.register.update.triggerAll(),c.register.event.dropdownCloseAll(),f.dropdownContent&&f.dropdownContent.classList.toggle("show")}),f.icon=function(a){return f.innerHTML="<i class='"+a+"'></i>",f},f.update=function(a){return c.register.update.define(f,a),f},f.highlight=function(a,b){this.update(function(d){var e=b?c.register.cmd.value(a,b)==b:c.register.cmd.state(a);e?d.classList.add("highlight"):d.classList.remove("highlight")})},f.parent=function(){return e},f.dropdownContent=null,f.dropdownCallback=null,f.dropdown=function(a){return f.classList.add("dropbtn"),f.dropdownContent=document.createElement("div"),f.dropdownContent.classList.add("dropdown-content"),e.appendChild(f.dropdownContent),f.dropdownCallback=a,f},f.menu=function(b,d){var e=document.createElement("a");return e.innerHTML=b,e.addEventListener("click",function(e){e.preventDefault(),f.dropdownCallback&&f.dropdownCallback.call(c,d||b,f),"function"==typeof a&&f.dropdownCallback.call(c,f)}),f.dropdownContent.appendChild(e),f},f.modal=function(a){a.call(c,f)},c.append(e),f},input:function(a,b){var d=document.createElement("input");return d.type="string"==typeof a?a:"text",b||(b=a),d.addEventListener("change",function(a){b.call(c,a)}),d.icon=function(a){d.innerHTML="<i class='"+a+"'></i>"},c.append(d),d},editor:function(){var a=document.createElement("div");if(a.classList.add("editor"),a.contentEditable=!0,c.register.threadEvent(a,"click keyup focus mouseup",function(){c.register.update.triggerAll()}),c.register.threadEvent(a,"blur keyup paste input focus",function(){c.el.value=this.innerHTML},c.options.debounce||10),c.el.addEventListener("change",function(){a.innerHTML=c.el.value}),c.options.debugMode||(c.el.style.display="none"),c.options.pastAsPlain&&a.addEventListener("paste",function(a){if(a.preventDefault(),!c.options.preventPaste){var b=(a.originalEvent||a).clipboardData.getData("text/plain")||prompt("Paste something..");c.register.action("insertText",b)}}),c.options.preventPaste&&a.addEventListener("paste",function(a){a.preventDefault()}),c.options.expandable||(a.style.height=c.options.height||100,a.style.overflow="auto"),c.options.showOnFocus){var b=!1,d=!1;c.container.classList.add("onfocus"),c.container.addEventListener("mouseover",function(){c.container.classList.add("focused"),d=!0}),c.container.addEventListener("mouseout",function(){b||c.container.classList.remove("focused"),d=!1}),a.addEventListener("focus",function(a){b||(b=!0,c.container.classList.add("focused"))}),a.addEventListener("mouseover",function(a){b||c.container.classList.add("focused")}),a.addEventListener("blur",function(a){b=!1,d||c.container.classList.remove("focused")}),a.addEventListener("mouseout",function(a){b||d||c.container.classList.remove("focused")})}return c.register.event.disableAllButtons(!0),a.addEventListener("focus",function(a){c.register.event.disableAllButtons(!1)}),a.addEventListener("blur",function(a){c.register.event.disableAllButtons(!0)}),c.append(a),c.editor=a,a}},this.register={action:function(a,b){"h1"==a||"h2"==a||"h3"==a||"h4"==a||"h5"==a||"h6"==a||"p"==a||"blockquote"==a||"pre"==a||"div"==a||"code"==a?document.execCommand("formatBlock",!1,a):"forecolor"==a||"backcolor"==a?document.execCommand(a,!1,b):"print"==a?this.doPrint():"createlink"==a||"insertimage"==a?(url=prompt("Enter the link here: ","http://"),document.execCommand(a,!1,url)):document.execCommand(a,!1,b)},cmd:{state:function(a){return document.queryCommandState(a)},value:function(a){return document.queryCommandValue(a)}},threadTimer:{},threadTime:100,threadEvent:function(a,b,d,e){var b=b.split(" ");for(var f in b)a.addEventListener(b[f],function(){clearTimeout(c.register.threadTimer[b]),c.register.threadTimer[b]=setTimeout(function(){d.call(a,b[f])},e||c.register.threadTime)})},doPrint:function(){var a=window.open("","_blank","width=450,height=470,left=400,top=100,menubar=yes,toolbar=no,location=no,scrollbars=yes");a.document.open(),a.document.write('<!doctype html><html><head><title>Print</title></head><body onload="print();">'+c.editor.innerHTML+"</body></html>"),a.document.close()},toolbar:function(a){c.options.toolbar+=" "+a},update:{list:[],define:function(a,b){this.list.push([a,b])},triggerAll:function(){for(var a in this.list)this.list[a][1].call(c,this.list[a][0])}},event:{dropdownCloseListener:function(){var a=this;window.onclick=function(b){b.target.matches(".dropbtn")||b.target.matches("i")||a.dropdownCloseAll()}},dropdownCloseAll:function(){var a,b=document.getElementsByClassName("dropdown-content");for(a=0;a<b.length;a++){var c=b[a];c.classList.contains("show")&&c.classList.remove("show")}},disableAllButtons:function(a){var b,d=document.querySelectorAll(".microEditor-idx"+c.idx+" .button-container>button");for(b=0;b<d.length;b++){var e=d[b];e.disabled=a}}}},this.prepare=function(){this.container=document.createElement("div"),this.container.classList.add("microEditor"),this.container.classList.add("microEditor-idx"+this.idx);var a=this.getIndex();this.el.parentNode.insertBefore(this.container,this.el.parentNode.childNodes[a])},this.append=function(a){this.container.appendChild(a)},this.getIndex=function(){for(var a=0,b=this.el;b=b.previousSibling;)++a;return a},this.init(),this};microEditor.plugins={init:{},list:{},register:function(a,b,c){this.list[a]=b,c&&(this.init[a]=c)}},microEditor.plugins.register("blockquote",function(){this.create.button(function(){this.register.action("blockquote")}).icon("fa fa-quote-left")}),microEditor.plugins.register("bold",function(){this.create.button(function(){this.register.action("bold")}).icon("fa fa-bold").highlight("bold")}),microEditor.plugins.register("createlink",function(){this.create.button(function(){this.register.action("createlink")}).icon("fa fa-link")}),microEditor.plugins.register("fontName",function(){this.create.button().icon("fa fa-font").dropdown(function(a){this.register.action("fontName",a)}).menu("Tahoma (Mac Only Font)","Tahoma").menu("Arial")},function(){this.register.toolbar("fontName")}),microEditor.plugins.register("fontSize",function(){this.create.button().icon("fa fa-text-height").dropdown(function(a){this.register.action("fontSize",a)}).menu(1).menu(2).menu(3).menu(4).menu(5).menu(6).menu(7)},function(){this.register.toolbar("fontSize")}),microEditor.plugins.register("heading",function(){this.create.button().icon("fa fa-paragraph").dropdown(function(a){this.register.action(a)}).menu("DIV","div").menu("P","p").menu("H1","h1").menu("H2","h2").menu("H3","h3").menu("H4","h4").menu("H5","h5").menu("H6","h6")},function(){this.register.toolbar("heading")}),microEditor.plugins.register("indent",function(){this.create.button(function(){this.register.action("indent")}).icon("fa fa-indent").highlight("indent")}),microEditor.plugins.register("insertimage",function(){this.create.button(function(){this.register.action("insertimage")}).icon("fa fa-image")}),microEditor.plugins.register("insertOrderedList",function(){this.create.button(function(){this.register.action("insertOrderedList")}).icon("fa fa-list-ol").highlight("insertorderedlist")}),microEditor.plugins.register("insertUnorderedList",function(){this.create.button(function(){this.register.action("insertUnorderedList")}).icon("fa fa-list-ul").highlight("insertunorderedlist")}),microEditor.plugins.register("italic",function(){this.create.button(function(){this.register.action("italic")}).icon("fa fa-italic").highlight("italic")}),microEditor.plugins.register("justifyCenter",function(){this.create.button(function(){this.register.action("justifyCenter")}).icon("fa fa-align-center").highlight("justifycenter")}),microEditor.plugins.register("justifyFull",function(){this.create.button(function(){this.register.action("justifyFull")}).icon("fa fa-align-justify").highlight("justifyfull")}),microEditor.plugins.register("justifyLeft",function(){this.create.button(function(){this.register.action("justifyLeft")}).icon("fa fa-align-left").highlight("justifyleft")}),microEditor.plugins.register("justifyRight",function(){this.create.button(function(){this.register.action("justifyRight")}).icon("fa fa-align-right").highlight("justifyright")}),microEditor.plugins.register("outdent",function(){this.create.button(function(){this.register.action("outdent")}).icon("fa fa-outdent").highlight("outdent")}),microEditor.plugins.register("print",function(){this.create.button(function(){this.register.action("print")}).icon("fa fa-print")}),microEditor.plugins.register("redo",function(){this.create.button(function(){this.register.action("redo")}).icon("fa fa-repeat")}),microEditor.plugins.register("removeFormat",function(){this.create.button(function(){this.register.action("removeFormat")}).icon("fa fa-eraser")}),microEditor.plugins.register("strikeThrough",function(){this.create.button(function(){this.register.action("strikeThrough")}).icon("fa fa-strikethrough").highlight("strikethrough")}),microEditor.plugins.register("subscript",function(){this.create.button(function(){this.register.action("subscript")}).icon("fa fa-subscript").highlight("subscript")}),microEditor.plugins.register("superscript",function(){this.create.button(function(){this.register.action("superscript")}).icon("fa fa-superscript").highlight("superscript")}),microEditor.plugins.register("underline",function(){this.create.button(function(){this.register.action("underline")}).icon("fa fa-underline").highlight("underline")}),microEditor.plugins.register("undo",function(){this.create.button(function(){this.register.action("undo")}).icon("fa fa-undo")}),microEditor.plugins.register("unlink",function(){this.create.button(function(){this.register.action("unlink")}).icon("fa fa-unlink")});